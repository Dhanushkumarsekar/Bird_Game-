<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice-Controlled Flappy Bird</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Welcome Screen -->
        <div id="welcome-screen" class="screen active">
            <div class="welcome-content">
                <h1 class="game-title">üé§ Voice-Controlled Flappy Bird</h1>
                <p class="game-description">Control the bird with your voice! Use any sound - voice commands, claps, or whistles!</p>
                
                <div class="form-group">
                    <label for="player-name" class="form-label">Enter Your Name:</label>
                    <input type="text" id="player-name" class="form-control" placeholder="Your name here..." maxlength="20">
                </div>
                
                <div class="button-group">
                    <button id="start-game-btn" class="btn btn--primary btn--lg">Start Game üöÄ</button>
                    <button id="view-leaderboard-btn" class="btn btn--secondary btn--lg">Leaderboard üèÜ</button>
                </div>
                
                <div class="instructions">
                    <h3>How to Play:</h3>
                    <ul>
                        <li>üéôÔ∏è Allow microphone access when prompted</li>
                        <li>üó£Ô∏è Say: "flap", "up", "jump", "go", "fly"</li>
                        <li>üëè Or make ANY sound (clap, whistle, etc.)</li>
                        <li>‚ú® Navigate through the pipes</li>
                        <li>üéØ Get the highest score possible!</li>
                        <li>‚å®Ô∏è Spacebar works as backup control</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Voice Calibration Screen -->
        <div id="calibration-screen" class="screen">
            <div class="calibration-content">
                <h2>üé§ Voice Setup</h2>
                <p class="calibration-instructions">Let's calibrate your microphone for the best experience!</p>
                
                <div class="calibration-controls">
                    <div class="voice-meter-container">
                        <label class="form-label">Voice Activity Monitor</label>
                        <div class="voice-meter">
                            <div id="voice-level-bar" class="voice-level-bar"></div>
                            <div class="voice-threshold-line"></div>
                        </div>
                        <div class="voice-meter-labels">
                            <span>Silent</span>
                            <span>Loud</span>
                        </div>
                    </div>
                    
                    <div class="sensitivity-control">
                        <label for="sensitivity-slider" class="form-label">Sensitivity</label>
                        <input type="range" id="sensitivity-slider" class="sensitivity-slider" 
                               min="0.1" max="0.8" step="0.1" value="0.3">
                        <div class="sensitivity-labels">
                            <span>Low</span>
                            <span>High</span>
                        </div>
                    </div>
                    
                    <div class="test-area">
                        <button id="test-voice-btn" class="btn btn--secondary">Test Voice Commands</button>
                        <div id="voice-test-feedback" class="voice-test-feedback"></div>
                        <div id="detection-count" class="detection-count">Commands Detected: <span>0</span></div>
                    </div>
                </div>
                
                <div class="voice-commands">
                    <h4>Supported Commands:</h4>
                    <div class="command-badges">
                        <span class="command-badge">"flap"</span>
                        <span class="command-badge">"up"</span>
                        <span class="command-badge">"jump"</span>
                        <span class="command-badge">"go"</span>
                        <span class="command-badge">"fly"</span>
                        <span class="command-badge">Any Sound</span>
                    </div>
                </div>
                
                <div class="calibration-tip">
                    <p><strong>Tip:</strong> The green line shows the detection threshold. Make sure your voice reaches above it!</p>
                </div>
                
                <div class="button-group">
                    <button id="continue-game-btn" class="btn btn--primary btn--lg">Continue to Game üéÆ</button>
                    <button id="back-to-welcome-btn" class="btn btn--outline">Back</button>
                </div>
            </div>
        </div>

        <!-- Countdown Screen -->
        <div id="countdown-screen" class="screen">
            <div class="countdown-content">
                <h2>Get Ready!</h2>
                <div id="countdown-number" class="countdown-number">3</div>
                <p class="countdown-instructions">Voice detection is active - make any sound to control the bird!</p>
                
                <div class="countdown-voice-status">
                    <div class="mini-voice-meter">
                        <div id="countdown-voice-bar" class="mini-voice-bar"></div>
                    </div>
                    <span id="countdown-voice-text">Listening...</span>
                </div>
                
                <div class="voice-commands">
                    <span class="command-badge">"flap"</span>
                    <span class="command-badge">"up"</span>
                    <span class="command-badge">"jump"</span>
                    <span class="command-badge">"go"</span>
                    <span class="command-badge">Any Sound</span>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen">
            <div class="game-header">
                <div class="score-display">
                    <span class="score-label">Score:</span>
                    <span id="current-score" class="score-value">0</span>
                </div>
                <div class="voice-status">
                    <div id="mic-indicator" class="mic-indicator">
                        <span class="mic-icon">üé§</span>
                        <div class="voice-activity-bar">
                            <div id="game-voice-bar" class="game-voice-bar"></div>
                        </div>
                        <span id="mic-status" class="mic-status-text">Listening...</span>
                    </div>
                </div>
            </div>
            
            <div class="game-container">
                <canvas id="game-canvas" width="800" height="600"></canvas>
                <div id="voice-feedback" class="voice-feedback"></div>
                <div id="command-counter" class="command-counter">Commands: <span id="command-count">0</span></div>
            </div>
            
            <div class="game-controls">
                <button id="pause-btn" class="btn btn--outline btn--sm">Pause ‚è∏Ô∏è</button>
                <div class="live-sensitivity">
                    <span>Sensitivity:</span>
                    <input type="range" id="game-sensitivity" class="mini-slider" 
                           min="0.1" max="0.8" step="0.1" value="0.3">
                </div>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="game-over-screen" class="screen">
            <div class="game-over-content">
                <h2>Game Over!</h2>
                <div class="final-score">
                    <p>Final Score:</p>
                    <div id="final-score-value" class="score-big">0</div>
                </div>
                
                <div id="game-stats" class="game-stats">
                    <div class="stat-item">
                        <span class="stat-label">Voice Commands:</span>
                        <span id="final-commands" class="stat-value">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Detection Rate:</span>
                        <span id="detection-rate" class="stat-value">100%</span>
                    </div>
                </div>
                
                <div id="new-record" class="new-record hidden">
                    <div class="status status--success">üéâ New High Score!</div>
                </div>
                
                <div id="current-rank" class="current-rank">
                    <p>Your Rank: <span id="rank-value">#-</span></p>
                </div>
                
                <div class="button-group">
                    <button id="try-again-btn" class="btn btn--primary btn--lg">Try Again üîÑ</button>
                    <button id="view-scores-btn" class="btn btn--secondary btn--lg">Leaderboard üìä</button>
                    <button id="main-menu-btn" class="btn btn--outline">Main Menu üè†</button>
                </div>
            </div>
        </div>

        <!-- Leaderboard Screen -->
        <div id="leaderboard-screen" class="screen">
            <div class="leaderboard-content">
                <h2>üèÜ Leaderboard</h2>
                <div class="leaderboard-table">
                    <div class="leaderboard-header">
                        <div class="rank-col">Rank</div>
                        <div class="name-col">Player</div>
                        <div class="score-col">Score</div>
                        <div class="commands-col">Commands</div>
                    </div>
                    <div id="leaderboard-list" class="leaderboard-list">
                        <!-- Scores will be populated here -->
                    </div>
                </div>
                
                <div class="button-group">
                    <button id="play-again-btn" class="btn btn--primary btn--lg">Play Again üéÆ</button>
                    <button id="back-to-menu-btn" class="btn btn--outline">Back to Menu</button>
                </div>
            </div>
        </div>

        <!-- Microphone Permission Modal -->
        <div id="mic-permission-modal" class="modal hidden">
            <div class="modal-content">
                <h3>üé§ Microphone Access Required</h3>
                <p>This game requires microphone access to detect your voice commands and sounds. We use advanced detection to catch every command!</p>
                
                <div class="permission-features">
                    <div class="feature-item">‚úÖ Speech recognition for voice commands</div>
                    <div class="feature-item">‚úÖ Audio level detection for any sound</div>
                    <div class="feature-item">‚úÖ Real-time voice activity monitoring</div>
                    <div class="feature-item">‚úÖ Adjustable sensitivity settings</div>
                </div>
                
                <div class="button-group">
                    <button id="request-mic-btn" class="btn btn--primary">Allow Microphone</button>
                    <button id="cancel-mic-btn" class="btn btn--outline">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Troubleshooting Modal -->
        <div id="troubleshoot-modal" class="modal hidden">
            <div class="modal-content">
                <h3>üîß Voice Detection Troubleshooting</h3>
                <div class="troubleshoot-content">
                    <h4>If voice commands aren't working:</h4>
                    <ul>
                        <li>Check that your microphone is connected and working</li>
                        <li>Make sure you've allowed microphone permissions</li>
                        <li>Increase the sensitivity using the slider</li>
                        <li>Speak clearly and loudly enough</li>
                        <li>Try making other sounds like clapping or whistling</li>
                        <li>Use spacebar as a backup control</li>
                    </ul>
                    
                    <h4>Browser Compatibility:</h4>
                    <p>This game works best in Chrome, Edge, or Safari. Firefox has limited speech recognition support.</p>
                </div>
                
                <div class="button-group">
                    <button id="close-troubleshoot-btn" class="btn btn--primary">Got It</button>
                    <button id="test-again-btn" class="btn btn--secondary">Test Again</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>